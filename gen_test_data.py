import pandas as pd
import haversine as hs

sequences = {'sequence': [], 'sTime':[], 'mTime':[], 'rTime':[], 'rtt_diff':[], 'label':[]}

locations = {'AV':[44.747184, -93.199922], 'chicago':[41.9463168, -87.687168], 'SLP':[44.953454,-93.351227], 'london':[51.5072, 0.1276], 'madison':[40.68169, -89.410652], 'mpls':[44.973170,-93.223129]}
messages_1 = [[18.430532, 18.479909, 18.752368],
            [20.752256, 20.802529, 20.954658],
            [22.943327, 22.995847, 23.591056],
            [25.232534, 25.285785, 25.524517],
            [27.800720, 27.851607, 27.076800],
            [30.029905, 30.080182, 30.694406],
            [32.443329, 32.495971, 32.708500],
            [35.021570, 35.072062, 35.198623],
            [37.544851, 37.596429, 37.740138],
            [40.262446, 40.313061, 40.436327],
            [42.676217, 42.727345, 42.884494],
            [44.911477, 44.962840, 45.008431],
            [47.340649, 47.403118, 47.478780]]

messages_2 = [[1.574764797, 1.619130235, 2.212283537],
            [2.427443690, 2.474329649, 3.066776059],
            [2.056582945, 2.105142781, 2.766016088],
            [1.115279050, 1.169388771, 1.781271126],
            [1.049663109, 1.114273210, 1.437005987],
            [0.706486262, 0.740461258, 1.081665443],
            [0, 0.072430383, 0.302203906],
            [0.782938080, 0.817002084, 1.040764048],
            [0.723151824, 0.795198154, 1.116553840],
            [2.132375497, 2.183426085, 2.521090671]]

messages_3 = [[13.560625, 13.614266, 13.712244],
            [15.543776, 15.595414, 17.019833],
            [18.799262, 18.853837, 20.215413],
            [22.147383, 22.199413, 23.573942],
            [25.164738, 25.215123, 26.819466],
            [28.760912, 28.813749, 30.127176],
            [32.215841, 32.267308, 33.423737],
            [35.583732, 35.733815, 36.792807],
            [39.093588, 39.143546, 40.050408],
            [42.405740, 42.458128, 43.409728]]

messages_4 = [[16.499280, 16.585200, 16.74834],
            [19.802448, 19.885164, 20.022672],
            [23.156906, 23.243227, 23.385168],
            [26.747302, 26.865812, 26.963613],
            [30.554455, 30.642724, 30.788587],
            [34.014143, 34.098352, 34.238171],
            [37.856816, 37.993712, 38.033019],
            [41.640079, 41.725356, 41.826056],
            [52.514653, 52.603934, 52.704085],
            [56.313779, 56.399263, 56.457232]]

messages_5 = [[9.054599, 9.139932, 9.2149095],
            [11.412332, 11.506713, 12.548149],
            [15.491082, 15.575793, 15.873966],
            [18.211806, 18.297642, 19.230747],
            [21.484154, 21.571156, 22.971603],
            [25.507899, 25.499954, 26.204419],
            [29.248766, 29.338438, 29.603279],
            [31.745568, 31.830636, 32.996221],
            [35.280871, 35.372138, 36.370009],
            [38.112780, 38.210904, 39.751322],
            [41.55394, 41.653526, 43.143986]]

messages_6 = [[72.650832, 72.680504, 72.750440],
            [77.225658, 77.255362, 77.374644],
            [81.142516, 81.172167, 81.252392],
            [85.508258, 85.537607, 85.610984],
            [90.184653, 90.214479, 90.286645],
            [94.682730, 94.715223, 94.791940],
            [99.701792, 99.731629, 99.854782],
            [105.074441, 105.104143, 105.185810],
            [115.160500, 115.190831, 115.312355],
            [123.261124, 123.290790, 123.453972]]

vpn = [[29.637759, 29.667235, 30.380167],
    [34.884184, 34.913878, 35.550682],
    [39.830588, 39.867772, 40.506300],
    [49.375336, 49.405036, 50.081730],
    [54.743054, 54.772533, 55.415037],
    [59.813500, 59.842776, 60.469873],
    [63.953075, 63.982590, 64.621852],
    [68.655788, 68.686658, 69.327949],
    [73.655916, 73.685228, 74.420650],
    [79.229394, 79.258973, 79.894757],
    [84.125155, 84.154681, 84.793667]]

messages =[messages_1,messages_2,messages_3,messages_4, messages_5,messages_6]

delta = 1

av_c = hs.haversine(locations['AV'], locations['chicago'])
print("APPLE VALLEY AND CHICAGO: " + str(av_c))
av_slp = hs.haversine(locations['AV'], locations['SLP'])
print("APPLE VALLEY AND ST. LOUIS PARK: " + str(av_slp))
msp_c = hs.haversine(locations['chicago'], locations['mpls'])
print("MINNEAPOLIS AND CHICAGO: " + str(msp_c))
msp_l = hs.haversine(locations['mpls'], locations['london'])
print("LONDON AND MINNEAPOLIS: " + str(msp_l))
msp_mad = hs.haversine(locations['mpls'], locations['madison'])
print("MINNEAPOLIS AND MADDISON: " + str(msp_mad))
seq_id = 0
for i in range(len(messages)):
    if i == 0:
        label = 1
    if i == 1: 
        label = 1
    if i == 2:
        label = 0
    if i == 3:
        label = 1
    if i == 4:
        label = 7
    if i == 5:
        label = 1
    for item in messages[i]:
        sequences['sequence'].append(i)
        sequences['sTime'].append(item[0])
        sequences['mTime'].append(item[1]+delta-item[0])
        sequences['rTime'].append(item[2]+delta-item[0])
        sequences['rtt_diff'].append((item[2]+delta-item[0])-(item[1]+delta-item[0]))
        sequences['label'].append(label)


vpn_seq = {'sequence': [], 'sTime':[], 'mTime':[], 'rTime':[], 'rtt_diff':[], 'label':[]}

for item in vpn:
    vpn_seq['sequence'].append(6)
    vpn_seq['sTime'].append(item[0])
    vpn_seq['mTime'].append(item[1]-item[0])
    vpn_seq['rTime'].append(item[2]-item[0])
    vpn_seq['rtt_diff'].append((item[2]-item[0])-(item[1]-item[0]))
    vpn_seq['label'].append(0)


df = pd.DataFrame.from_dict(sequences)
df.to_csv('test_data_d_10.csv')

v_df = pd.DataFrame.from_dict(vpn_seq)
v_df.to_csv('vpn_test_data.csv')